---
import hexToRgb from "../helpers.ts";
interface Props {
	name: string;
	icon: string;
	category: string;
	color: string;
}

const { name, icon, category, color } = Astro.props;

const rgb = hexToRgb(color);
const backgroundColorHover = `rgba(${rgb.r}, ${rgb.g}, ${rgb.b}, 0.15)`;
const backgroundColorNormal = `rgba(${rgb.r}, ${rgb.g}, ${rgb.b}, 0.08)`;
const borderColorHover = `rgba(${rgb.r}, ${rgb.g}, ${rgb.b}, 0.3)`;
const shadowColor = `rgba(${rgb.r}, ${rgb.g}, ${rgb.b}, 0.2)`;
---

<div
	class="tech-item group relative flex flex-col items-center p-3 rounded-lg border transition-all duration-300 hover:scale-105 cursor-pointer"
	data-category={category}
	style={`
        background-color: ${backgroundColorNormal};
        border-color: rgba(71, 85, 105, 0.3);
        --hover-bg: linear-gradient(135deg, ${backgroundColorHover}, rgba(30, 41, 59, 0.6));
        --hover-border: ${borderColorHover};
        --hover-shadow: 0 8px 25px -8px ${shadowColor};
    `}
>
	<div class="w-9 h-9 flex items-center justify-center relative">
		<img
			height="24"
			width="24"
			src={`https://cdn.simpleicons.org/${icon}`}
			alt={`${name} icon`}
			class="w-full h-full object-contain filter brightness-90 group-hover:brightness-110 transition-all duration-300 relative z-10"
			onerror={`this.onerror=null; this.src='/src/assets/tech/${icon}.svg'`}
		/>
		<!-- Subtle glow effect behind icon -->
		<div
			class="absolute inset-0 rounded-full opacity-0 group-hover:opacity-30 transition-opacity duration-300 blur-sm"
			style={`background: radial-gradient(circle, ${color}40, transparent 70%);`}
		>
		</div>
	</div>

	<!-- Enhanced tooltip -->
	<div
		class="absolute -top-5 left-1/2 transform -translate-x-1/2 bg-slate-900/95 text-white text-xs px-2 py-1 rounded-md opacity-0 group-hover:opacity-100 transition-all duration-300 pointer-events-none whitespace-nowrap backdrop-blur-sm border border-slate-700/50"
		style={`box-shadow: 0 4px 12px ${shadowColor};`}
	>
		{name}
		<div
			class="absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-2 border-r-2 border-t-2 border-transparent border-t-slate-900/95"
		>
		</div>
	</div>
</div>

<style>
	.tech-item {
		min-width: 50px;
	}

	.tech-item:hover {
		background: var(--hover-bg) !important;
		border-color: var(--hover-border) !important;
		box-shadow: var(--hover-shadow);
	}

	.tech-item::before {
		content: "";
		position: absolute;
		top: 0;
		left: 0;
		right: 0;
		bottom: 0;
		border-radius: inherit;
		background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), transparent);
		opacity: 0;
		transition: opacity 0.3s ease;
		pointer-events: none;
	}

	.tech-item:hover::before {
		opacity: 1;
	}
</style>
